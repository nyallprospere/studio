/**
 * @fileOverview Firestore Security Rules for the St. Lucia Elections Hub application.
 *
 * Core Philosophy:
 * This ruleset provides public read access to most data collections while restricting write access. The `archived_candidates` collection was missing the public read permissions that are in line with all the other top level data collections. This has been fixed. All write operations are disallowed to the public for all collections.
 *
 * Data Structure:
 * The Firestore database is structured into several top-level collections, each representing a core entity:
 * - `/parties/{partyId}`: Political party information.
 * - `/events/{eventId}`: Political events.
 * - `/candidates/{candidateId}`: Candidate information.
 * - `/archived_candidates/{archivedCandidateId}`: Archived candidate data.
 * - `/elections/{electionId}`: Election information.
 * - `/polling_data/{pollingDataId}`: Polling data for elections.
 * - `/constituencies/{constituencyId}`: Constituency information.
 * - `/election_results/{electionResultId}`: Election results.
 * - `/settings/pageLayouts`: User-defined layouts for pages (single document).
 * - `/settings/site`: Global site settings (single document).
 * - `/user_activity/{activityId}`: User activity logs.
 *
 * Key Security Decisions:
 * - Public read access is granted to the `parties`, `events`, `candidates`, `archived_candidates`, `elections`, `polling_data`, `constituencies`, and `election_results` collections.
 * - Write access (create, update, delete) is denied for all users on all collections, providing read-only data for prototyping purposes.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Grants public read access to party information and restricts write access.
     * @path /parties/{partyId}
     * @allow (get, list): Any user can read party information.
     * @deny (create, update, delete): No user can create, update, or delete party information.
     * @principle Allows public read access, restricts write access.
     */
    match /parties/{partyId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Grants public read access to event information and restricts write access.
     * @path /events/{eventId}
     * @allow (get, list): Any user can read event information.
     * @deny (create, update, delete): No user can create, update, or delete event information.
     * @principle Allows public read access, restricts write access.
     */
    match /events/{eventId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Grants public read access to candidate information and restricts write access.
     * @path /candidates/{candidateId}
     * @allow (get, list): Any user can read candidate information.
     * @deny (create, update, delete): No user can create, update, or delete candidate information.
     * @principle Allows public read access, restricts write access.
     */
    match /candidates/{candidateId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Grants public read access to archived candidate data and restricts write access.
     * @path /archived_candidates/{archivedCandidateId}
     * @allow (get, list): Any user can read archived candidate data.
     * @deny (create, update, delete): No user can create, update, or delete archived candidate data.
     * @principle Allows public read access, restricts write access.
     */
    match /archived_candidates/{archivedCandidateId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Grants public read access to election information and restricts write access.
     * @path /elections/{electionId}
     * @allow (get, list): Any user can read election information.
     * @deny (create, update, delete): No user can create, update, or delete election information.
     * @principle Allows public read access, restricts write access.
     */
    match /elections/{electionId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Grants public read access to polling data and restricts write access.
     * @path /polling_data/{pollingDataId}
     * @allow (get, list): Any user can read polling data.
     * @deny (create, update, delete): No user can create, update, or delete polling data.
     * @principle Allows public read access, restricts write access.
     */
    match /polling_data/{pollingDataId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Grants public read access to constituency information and restricts write access.
     * @path /constituencies/{constituencyId}
     * @allow (get, list): Any user can read constituency information.
     * @deny (create, update, delete): No user can create, update, or delete constituency information.
     * @principle Allows public read access, restricts write access.
     */
    match /constituencies/{constituencyId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Grants public read access to election result information and restricts write access.
     * @path /election_results/{electionResultId}
     * @allow (get, list): Any user can read election result information.
     * @deny (create, update, delete): No user can create, update, or delete election result information.
     * @principle Allows public read access, restricts write access.
     */
    match /election_results/{electionResultId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Restricts read and write access to page layout settings.
     * @path /settings/pageLayouts
     * @deny (get, list, create, update, delete): No user can read or write page layout settings.
     * @principle Restricts access to a single document.
     */
    match /settings/pageLayouts {
      allow get, list, create, update, delete: if false;
    }

    /**
     * @description Restricts read and write access to site settings.
     * @path /settings/site
     * @deny (get, list, create, update, delete): No user can read or write site settings.
     * @principle Restricts access to a single document.
     */
    match /settings/site {
      allow get, list, create, update, delete: if false;
    }

   /**
     * @description Restricts access to user activity logs.
     * @path /user_activity/{activityId}
     * @deny (get, list, create, update, delete): No user can read or write user activity.
     * @principle Restricts access to a single document.
     */
    match /user_activity/{activityId} {
      allow get, list, create, update, delete: if false;
    }
  }
}