
rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Allow public read access to all files.
    match /{allPaths=**} {
      allow read: if true;
    }

    // Allow public write access for map sharing images.
    match /SavedMaps/{allPaths=**} {
      allow write: if true;
    }

    // Restrict writes in other admin folders to authenticated users.
    match /{folder}/{allPaths=**} {
      allow write: if request.auth != null &&
                   folder in ['candidates', 'constituency-logos', 'events', 'leaders', 'logos', 'maps', 'news', 'parties'];
    }
  }
}
